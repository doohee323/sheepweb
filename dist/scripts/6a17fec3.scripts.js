"use strict";var config={url:"http://sheeprails.herokuapp.com",server:"rails"};angular.module("sheepwebApp",["ngResource"]).constant("config",config).config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{redirectTo:"/centers"}).when("/centers",{controller:"CentersCtrl",templateUrl:"./views/centers.html"}).when("/center/:id",{controller:"CentersCtrl",templateUrl:"./views/centers.html"}).when("/regions/:id",{controller:"RegionsCtrl",templateUrl:"/views/regions.html"}).otherwise({redirectTo:"/centers"}),b.html5Mode(!0).hashPrefix("!")}]),angular.module("sheepwebApp").directive("ngView",["$route","$anchorScroll","$compile","$controller",function(a,b,c,d){return{restrict:"ECA",terminal:!0,link:function(e,f,g){function h(){n&&(n.$destroy(),n=null)}function i(){f.html(""),h()}function j(){o=a.current&&a.current.locals,p=o&&o.$template,p?r.disabled?m():f.children().length>0?l(r.viewExitAnimation):k(r.viewEnterAnimation):i()}function k(a){$(f).css("display","block"),m(),l(a)}function l(a){switch(a){case"fadeOut":$(f.children()).animate({},r.duration,function(){k("slideLeft")});break;case"slideLeft":$(f.children()).animate({left:"-="+r.slideAmount,opacity:1},r.duration);break;case"slideRight":$(f.children()).animate({left:"+="+r.slideAmount,opacity:1},r.duration)}}function m(){f.html(p),h();var g,i=c(f.contents()),j=a.current;n=j.scope=e.$new(),j.controller&&(o.$scope=n,g=d(j.controller,o),f.children().data("$ngControllerController",g)),i(n),n.$emit("$viewContentLoaded"),n.$eval(q),b()}var n,o,p,q=g.onload||"",r={duration:500,viewEnterAnimation:"slideLeft",viewExitAnimation:"fadeOut",slideAmount:50,disabled:!1},s=e.$eval(g.animations);angular.extend(r,s),e.$on("$routeChangeSuccess",j),j()}}}]),angular.module("sheepwebApp").controller("CentersCtrl",["$scope","$location","$routeParams","config","CenterService",function(a,b,c,d,e){a.$location=b,a.newCenter={},e.get({},function(d){if(a.uip_centers=d.uip_centers,"/centers"!=b.$$path){var e=c.id;f(e,function(b){a.newCenter=a.uip_centers[b]})}}),a.addCenter=function(){a.newCenter.id="";var b={uip_center:a.newCenter};e.save(b,function(b){a.uip_centers.unshift(b.uip_center),console.log(b)})},a.updateCenter=function(b){var c={uip_center:a.newCenter,id:a.newCenter.id};e.update(c,function(c){console.log(c),f(b.id,function(c){a.uip_centers[c]=b})})},a.deleteCenter=function(b){e.delete({id:b.id},function(c){console.log(c),f(b.id,function(b){a.uip_centers.splice(b,1)}),a.newregion={}})},a.initCenter=function(){a.newCenter={}};var f=function(b,c){for(var d=a.uip_centers.length-1;d>=0;d--)if(a.uip_centers[d].id==b+""){c(d);break}}}]),angular.module("sheepwebApp").controller("NavbarCtrl",["$scope","$location",function(a,b){a.goTo=function(c,d){var e=c;"/"==c||(d?e+=d.id:a.uip_centers[0]&&(e+=a.uip_centers[0].id)),b.path(e)}}]),angular.module("sheepwebApp").directive("commbutton",["$compile",function(a){var b=function(a,b,c){var d='<button id="'+a+b+'" class="btn btn-primary" type="button" ng-click="'+a+b;return d+=c?"("+c+')"':'()"',"add"==a&&(d+=' ng-disabled="!new'+b+".name || !new"+b+".chief || !new"+b+'.address"'),d+=">"+a+"</button>"},c=function(c,d,e){d.html(b(e.type,e.data,e.dataset)).show(),a(d.contents())(c)};return{restrict:"E",link:c,replace:!0}}]),angular.module("sheepwebApp").factory("CenterService",["$resource","config",function(a,b){return a(b.url+"/uip_centers/:id",{id:"@id"},{update:{method:"PUT"}})}]),angular.module("sheepwebApp").controller("RegionsCtrl",["$scope","$location","$routeParams","RegionService",function(a,b,c,d){a.$location=b,a.newRegion={};var e=c.id;d.get({uip_center_id:e},function(b){a.uip_regions=b.uip_regions,b.uip_regions.length>0&&(a.newRegion=b.uip_regions[0]),a.regionsTotal=b.uip_regions.length,a.newRegion.uip_center_id=e}),a.addRegion=function(){delete a.newRegion.id,delete a.newRegion.uip_center,a.newRegion.uip_center_id=e;var b={uip_region:a.newRegion};d.save(b,function(b){b.uip_region.uip_center_id=e,a.uip_regions.unshift(b.uip_region),console.log(b)})},a.editRegion=function(b){a.newRegion=b,a.newRegion.uip_center_id=b.uip_center.id},a.updateRegion=function(b){var c=angular.copy(a.newRegion);delete c.uip_center;var e={uip_region:c,id:a.newRegion.id};d.update(e,function(c){console.log(c),f(b.id,function(c){a.uip_regions[c]=b})})},a.deleteRegion=function(b){d.delete({id:b.id},function(c){console.log(c),f(b.id,function(b){a.uip_regions.splice(b,1)}),a.newRegion={}})},a.initRegion=function(){a.newRegion={}},a.goHomeRegion=function(){var a="/centers";b.path(a)},a.orderby="product",a.reverse=!1,a.setOrder=function(b){b===a.orderby&&(a.reverse=!a.reverse),a.orderby=b};var f=function(b,c){for(var d=a.uip_regions.length-1;d>=0;d--)if(a.uip_regions[d].id==b+""){c(d);break}}}]),angular.module("sheepwebApp").factory("RegionService",["$resource","config",function(a,b){return a(b.url+"/uip_regions/:id",{id:"@id"},{update:{method:"PUT"}})}]),angular.module("sheepwebApp").filter("agoText",function(){return function(a){return moment.lang("en"),moment(a).fromNow()}});